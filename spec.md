Image Classifier Application Design PlanThis document outlines the design plan for a modern web-based image classifier application, focusing on user-friendly folder and asset control, custom categorization, flexible naming patterns, and integration with Ollama for intelligent image inference.1. Vision & GoalsThe primary goal is to provide users with an efficient tool to:Ingest large batches of images.Intelligently classify images based on their content using Ollama.Allow users to define and apply custom categories.Enable flexible, pattern-based renaming of images incorporating both metadata and custom category information.Organize images into logical "filing cabinets" within the UI without necessarily duplicating physical files.2. User Interface (UI) DesignThe UI will prioritize a clean, intuitive, and modern aesthetic using React and Tailwind CSS, ensuring responsiveness across devices.2.1 Overall LayoutA multi-pane layout will be employed to facilitate navigation and content management:Left Sidebar: Navigation for "Filing Cabinets" (categories), "Uploads," "Settings."Main Content Area: Dynamic content based on the selected navigation item (e.g., image gallery, classification workflow, settings editor).Right Sidebar (Contextual): Appears when an image or batch is selected, showing details, classification suggestions, and actions.2.2 Key UI Components & Viewsa. Dashboard/Home ViewOverview of recent uploads, classification progress, and quick access to frequently used categories.Prominent "Upload Images" call-to-action.b. Image Upload ViewLarge, clearly marked drag-and-drop area for image files.Progress indicators for individual image uploads and overall batch upload.Option to select images via a file browser.c. Image Gallery / Asset Management ViewThumbnail Grid/List View: Displays images with essential metadata (filename, upload date, assigned categories).Filtering & Sorting: Options to filter by category, classification status (classified, unclassified, pending review), date, etc.Search Bar: For quick lookup of images by filename, category, or inferred tags.Multi-Selection: Enable users to select multiple images for bulk actions (classify, assign category, rename, move).Image Preview: Clicking an image opens a modal or expands a right sidebar for a larger preview and detailed information.d. Classification Workflow ViewBatch Processing View: Shows all images uploaded for classification, with their current status (e.g., PENDING, CLASSIFYING, REVIEW_NEEDED, FINALIZED).Ollama Suggestions: For each image, display Ollama's suggested categories and confidence scores.User Override/Refinement: Input fields or dropdowns to manually select/add/remove categories for individual images or selected batches.Progress Bar: Indicate the overall classification progress of a batch.e. Category Management ViewList of all user-defined custom categories.Add/Edit/Delete Category: Form to create new categories, modify existing ones (name, description, associated customSuffix for naming patterns).Visual indication of how many images are associated with each category.f. Naming Pattern EditorDrag-and-Drop Interface: A visual builder where users can drag "blocks" representing different metadata or custom fields to construct their desired filename pattern.Available Blocks:<Original Filename><Upload Date> (with configurable format:YYYY-MM-DD, DD-MM-YYYY, etc.)<Category Name> (the primary assigned category)<Custom Suffix> (defined per category)<Sequential Number> (for avoiding conflicts in batches)<User Defined Text>Live Preview: As the user builds the pattern, a real-time preview of a sample filename is shown.Option to save multiple naming presets.g. Filing Cabinets ViewA visual representation of the logical "folders" or categories. Each "cabinet" shows the category name and the number of images assigned to it.Clicking a cabinet filters the Image Gallery to show only images belonging to that specific category. This emphasizes logical organization over physical duplication.2.3 Setup and Installation Process (Hybrid Local/Web Model)To enable local file system interaction and Ollama integration, the application will operate on a hybrid model where a local backend service runs on the user's machine, and the web UI connects to it.a. Initial Setup/Onboarding ScreenUpon first launch or if the local backend is not detected, the UI will guide the user to download and run a small, self-contained local backend executable (e.g., a Python script wrapped with PyInstaller).Instructions for firewall exceptions and port forwarding (if applicable) will be provided.b. Local File System ConfigurationWithin the "Settings" view of the web UI, a dedicated section will allow the user to specify a root directory for the application on their local machine.This will involve:An input field for the file path (e.g., /Users/JohnDoe/ImageClassifierData).A "Browse" button (which triggers an API call to the local backend to open a system file picker and return the selected path).Validation by the local backend to ensure the path is accessible and writable.This specified path will be used for storing images, categorized subfolders, and application logs.c. Ollama Installation ConsoleA dedicated tab or section within "Settings" (e.g., "Ollama Setup") will provide a terminal-like interface for Ollama management.Installation Controls: Buttons such as "Check Ollama Installation," "Download Ollama Model (e.g., 'llava')", "Start Ollama Server" (if not already running as a service).Clicking these buttons will send commands to the local backend service.The backend will execute the corresponding shell commands (e.g., checking for ollama executable, ollama pull llava, ollama serve).Real-time Console Output: The local backend will capture the standard output and error streams from these commands and send them in real-time to the web UI. This will be displayed in the console pop-up, providing immediate feedback on installation progress, errors, or successful execution.Application Event Logging: Key application events (e.g., image upload completion, classification start/end, file system operations) generated by the local backend will also be streamed to this console for user visibility and debugging.3. Core Functionality & Workflow3.1 Image IngestionUsers upload images (single or batch) via drag-and-drop or file selection.The web UI sends these images to the local backend.The local backend stores the images in the user-specified root directory (or a staging subdirectory within it) and creates initial metadata entries in Firestore.3.2 Automated Classification (Ollama Integration)Upon upload, or explicitly triggered by the user, the local backend sends the images to the running Ollama instance (which it manages locally).Ollama (using a suitable vision model like llava) performs inference and returns a list of suggested categories/tags with confidence scores for each image.The local backend updates the image's Firestore database entry with Ollama suggestions.3.3 User Review & RefinementUsers review Ollama's classifications in the "Classification Workflow" view.They can accept, modify, or add new categories manually for individual images or in bulk.A "Confirm Classification" action finalizes the categories assigned to an image in Firestore.3.4 Naming & OrganizationOnce categories are finalized, users can apply the chosen naming pattern.The application calculates the new filename based on the pattern and image metadata/assigned categories.The currentFilename field in the image's database entry is updated.File System Action: When a user commits to a classification and naming pattern, the local backend will perform the actual file renaming and, optionally, move the image to a corresponding subfolder within the user-specified root directory (e.g., ImageClassifierData/FamilyVacations/2024-06-07-IMG_1234-summer.jpg).Crucially, images are logically assigned to categories in the database. This means an image id can be associated with multiple category_ids if necessary, but the UI will manage how it's presented to avoid perceived duplication within the UI's "Filing Cabinets."4. Data Model & Architecture4.1 Data Model (Firestore)We will use Firestore for data persistence, leveraging its real-time capabilities and flexible document structure.users Collection:{userId} (Document ID)settings Subcollection:{settingsId} (Document ID, e.g., user_prefs)namingPattern: Array<String> (e.g., ["<date>", "<filename>", "<customSuffix>"])dateFormat: String (e.g., "YYYY-MM-DD")defaultUploadFolder: String (ID of a default category)localRootPath: String (The user-specified root directory on their local file system)categories Subcollection:{categoryId} (Document ID)name: String (e.g., "Family Vacations", "Work Receipts")description: String (optional)customSuffix: String (optional, for naming patterns)createdAt: TimestampupdatedAt: Timestampimages Subcollection:{imageId} (Document ID)originalFilename: StringcurrentFilename: String (after renaming)fileExtension: StringuploadDate: TimestamplocalFilePath: String (relative path from localRootPath to the actual image file)ollamaSuggestedCategories: Array<String> (categories inferred by Ollama)userAssignedCategories: Array<String> (categories manually assigned by the user)status: String (e.g., UPLOADING, OLLAMA_PROCESSING, PENDING_REVIEW, FINALIZED)metadata: Map<String, Any> (e.g., {"dateTaken": "...", "cameraModel": "..."}, {"width": 1920, "height": 1080})thumbnailPath: String (relative path from localRootPath to a generated thumbnail, or base64 encoded thumbnail)createdAt: TimestampupdatedAt: Timestamp4.2 Backend Architecture (Local Component)The backend service will be a local application that the user runs on their machine. It acts as the bridge between the web UI (running in a browser) and the user's local system resources.Communication: The web UI will communicate with this local backend via HTTP/WebSocket requests (e.g., http://localhost:XXXX).Ollama Integration: This local backend is responsible for:Installing Ollama and managing model downloads (triggered by UI commands).Managing the Ollama server process (starting, stopping, monitoring), or simply checking if the system service is running.Forwarding images to the local Ollama instance for inference, typically by sending image data to Ollama's HTTP API (defaulting to http://localhost:11434/api/generate for completion or /api/chat for chat-like interactions with vision models).Parsing Ollama responses.Image Processing:Receiving image uploads from the web UI.Storing images in the user-specified localRootPath.Generating thumbnails.File System Interaction:Creating, renaming, and moving files/folders within the localRootPath based on user actions in the UI.Providing a mechanism for the web UI to "browse" local directories (e.g., opening a system file picker dialog via an API call).Logging & System Command Execution:Executing system commands (e.g., ollama pull).Capturing stdout/stderr and streaming it back to the web UI's console.Logging application events (e.g., file operations, Ollama status).5. Ollama Integration DetailsOllama will be the core intelligence for image understanding, managed by the local backend.Local Ollama Instance: The user will run Ollama directly on their machine. The local backend will ensure Ollama is accessible and a suitable vision model (e.g., llava) is downloaded.API Endpoint: The local backend will interact with the local Ollama API endpoint, which typically runs on http://localhost:11434. The backend will send image data as base64-encoded strings within the Ollama API request.Ollama Request: The backend will send a request to Ollama's generate or chat endpoint, including the base64-encoded image and a prompt designed to elicit relevant categories, e.g., "Describe the main subjects and context in this image and suggest 3-5 relevant categories in a comma-separated list."Structured Output: The Ollama response will be parsed to extract the suggested categories. This might involve guiding the Ollama model to produce structured output (e.g., JSON) through prompt engineering.Batch Processing: The backend will handle sending multiple images to Ollama in batches or sequentially to optimize performance, respecting Ollama's concurrent request limits.6. Technical StackFrontend:Framework: ReactStyling: Tailwind CSSState Management: React Context API or ZustandIcons: Lucide React, Font Awesome, or inline SVGsUI Components: Shadcn/ui (for robust and accessible UI elements)Backend (Local Component):Language: PythonFramework: FastAPI or Flask (for local HTTP API)Packaging: PyInstaller or similar (to create a self-contained executable)Ollama: Interfacing with the Ollama client/server via its HTTP API.Database:NoSQL Database: Google Cloud Firestore (for metadata and user settings)File Storage:Local File System: User-specified directory on their machine (managed by the local backend).7. Future EnhancementsVersion Control for Naming Patterns: Allow users to revert to previous naming patterns.AI-driven Tagging: Beyond categories, allow Ollama to generate free-form tags.Deduplication Detection: Identify and flag duplicate images during upload.Collaboration: Allow multiple users to work on the same image library (requires more complex Firestore security rules and shared local storage).Automation Rules: Set up rules to automatically classify and rename images based on certain criteria (e.g., "if image contains 'dog', assign to 'Pets' category").This updated design plan explicitly integrates Ollama, detailing how the local backend will interact with it for image classification, and how the UI will support its installation and management.